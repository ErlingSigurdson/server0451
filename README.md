# Концепция
Простой TCP-сервер для Linux, который:
- по запросу клиента-подписчика (предполагается, что это будет устройство IoT, такое как [Билли](https://github.com/ErlingSigurdson/Billy_the_Relay)) направляет ему команду "ВКЛ." или "ВЫКЛ.". 
- по команде клиента-постера (это может быть любое устройство, способное к коммуникации по TCP/IP) меняет заготовленную команду (предписанное положение нагрузки - опять же "ВКЛ." или "ВЫКЛ.") на указанную.

Синтаксис запросов и команд подчиняется настройкам, заданным в файле настроек (имя по умолчанию - `config_server0451.sh`). 
Приложение может быть запущено на сервере как в локальной сети, так и в глобальной - лишь бы был индивидуальный IP-адрес, по которому к серверу можно обратиться.

# Инструкция
### Запуск
Проще всего запустить bash-скрипт `loop_script_server0451.sh`, размещённый в директории `/sh`, при необходимости отредактировав его (например, если вы хотите изменить номера портов). Этот скрипт запускает сразу два экземпляра программы, используя порты 80 и 451 - первый для управления сервером, второй для запросов управляемого клиента.
Если разбираться более детально, то общий вид команды запуска приложения следующий:
```
sudo execute_server0451 -p <номер_порта> -f <путь_к_файлу_настроек> [-h][-v][-V] 
```
Bash-скрипт `oneshot_script_server0451` предназначен для отладки и знакомства с работой приложения.

### Файл настроек
У этого файла двойное назначение: он задаёт синтаксис команд и запросов, обрабатываемых сервером, и хранит текущее предписываемое положение нагрузки, которое будет передаваться клиенту по его запросу.
Если по заданному в опции `-f` пути файл отсутствует, то программа создаст его, указав значения по умолчанию (см. файл `cmd.h`). Он появится либо в директории, в которой находится исполняемый файл, или в директории, в которой находится скрипт, запускающий исполняемый файл.

### Протоколы
Сервер принимает от клиента-постера как простые строки, направляемые по TCP без использования протоколов более высоких уровней OSI (например, с помощью `netcat` или приложения для Android [Serial Wi-Fi terminal](https://serial-wifi-terminal.en.softonic.com/android)), так и HTTP-запросы. Приложение автоматически определит, что поступивший пакет является HTTP-запросом, и выдаст соответствующий протоколу HTTP ответ.
Управлять сервером через HTTP можно методами GET (указывая соответствующий синтаксису команд URI) и POST (указывая в теле запроса соответствующую синтаксису команд пару параметр+значение).
Наконец, при большом желании вы можете вручную поменять в файле настроек текущее предписанное положение нагрузки. Клиент-подписчик получит ответ на свой запрос исходя из нового содержимого файла.

# Справедливые вопросы
### Почему "0451"?
[Отсылка](https://gamenewsblog.ru/articles/chto-oznachaet-kod-0451-v-igrah-deus-ex-prey-i-system-shock/) к серии игр "Deus Ex".

### Что с безопасностью?
Это не то ПО, которое предназначено для выполнения ответственных задач, но если вы зададите в файле настроек уникальный синтаксис запросов и команд, то вашим сервером хотя бы нельзя будет сходу начать управлять, направляя рандомные команды.
